<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Introduction to R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">M8: Global change impacts on biodiversity</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Course schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="0_Intro.html">0. Introduction to R</a>
    </li>
    <li>
      <a href="1_Data.html">1. Biodiversity &amp; environmental data</a>
    </li>
    <li>
      <a href="2_patterns.html">2. Analyse biodiversity patterns</a>
    </li>
    <li>
      <a href="3_SDM_intro.html">3. SDMs: simple model fitting</a>
    </li>
    <li>
      <a href="4_SDM_eval.html">4. SDMs: assessment and prediction</a>
    </li>
    <li>
      <a href="5_SDM_algorithms.html">5. SDMs: algorithms</a>
    </li>
    <li>
      <a href="6_SDM_ensembles.html">6. SDMs: ensembles</a>
    </li>
    <li>
      <a href="7_SDM_conservation.html">7. SDMs: conservation applications</a>
    </li>
    <li>
      <a href="8_dispersal.html">8. Dispersal models</a>
    </li>
    <li>
      <a href="9_populations.html">9. Population dynamic models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:damaris@zurell.de">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://damariszurell.github.io">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ZurellLab">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to R</h1>

</div>


<hr />
<div id="getting-start-in-r" class="section level1">
<h1><span class="header-section-number">1</span> Getting start in R</h1>
<p>This tutorial provides a very brief recap of R basics. The materials are prerequisite for the remainder of the course. I highly recommend looking also at other tutorials (e.g. by <a href="http://adamwilson.us/SpatialDataScience/02_graphics.html">Adam Wilson</a>, by <a href="https://datacarpentry.org/R-ecology-lesson/04-visualization-ggplot2.html">Data carpentry</a>, or by <a href="https://cran.r-project.org/doc/contrib/Torfs+Brauer-Short-R-Intro.pdf">Paul Torfs and Claudia Brauer</a>) and books (e.g. <a href="http://r4ds.had.co.nz/">R for Data Science</a>, or <span class="citation">Crawley (2007)</span>). The RStudio <a href="https://www.rstudio.com/resources/cheatsheets/">cheat sheets</a> are also very helpful!</p>
<p><strong>What is R?</strong></p>
<ul>
<li>a very flexible, open source programming environment for (statistical) data analyses and visualisation (www.r-project.org)<br />
</li>
<li>an object oriented and interpreted programming language based on the S language<br />
</li>
<li>runs on all common operating systems</li>
</ul>
<p><strong>How to operate R:</strong></p>
<ul>
<li>R is operated from the command line<br />
</li>
<li>work with script files for easier tractability, recycling and modification of commands</li>
<li>scripts also allow you to send big chunks of code or the entire script to the R console<br />
</li>
<li>scripts are the first step for automatizing your data manipulation and analyses</li>
<li>R has a built-in editor, but many people nowadays use R Studio (<a href="http://rstudio.org/" class="uri">http://rstudio.org/</a>) or other text editors</li>
</ul>
<div id="console-and-prompt" class="section level2">
<h2><span class="header-section-number">1.1</span> Console and prompt</h2>
<p>In the R console you will find the symbol <code>&gt;</code>:</p>
<pre class="r"><code>&gt;</code></pre>
<p>This is the so-called <em>prompt</em>, which asks you for the next command. If you see a <code>+</code> instead, then the former command is not completed yet, and R waits for further arguments (maybe you have forgotten the closing bracket?).</p>
<pre class="r"><code>20 * (5 - 3
)</code></pre>
<p>A line break or a semicolon (;) separates commands.</p>
<pre class="r"><code>2 + 3; 2 + 4</code></pre>
<p>Anything following a hashmark <code>#</code>, will be interpreted as comment and will, thus, not be executed.</p>
<pre class="r"><code>1 + 3
# 1 + 3</code></pre>
<p>Upon opening a new R session, some useful information will be printed to the console, mainly on version number and copyright. You can also extract this and other useful information by typing commands, e.g.</p>
<pre class="r"><code>sessionInfo()
citation()</code></pre>
<p>The last command is important for citing the correct packages in your theses or any other publication.</p>
<p>You could type all code examples that are listed here, directly into your R console. You can access them by the cursor keys. However, I highly recommend storing everything into a script file.</p>
</div>
<div id="working-directory" class="section level2">
<h2><span class="header-section-number">1.2</span> Working directory</h2>
<p>R is always pointed at a specific directory on your computer, the working directory. You can check the current working directory by typing:</p>
<pre class="r"><code>getwd()</code></pre>
<p>The command for setting a working directory is <code>setwd()</code>. Check out the help page:</p>
<pre class="r"><code>?setwd</code></pre>
<div class="alert alert-info">
<p><strong><strong>Exercise:</strong></strong></p>
<p>Set up a course folder on your computer and set your R working directory to this folder.</p>
</div>
<p>See the files contained in your folder:</p>
<pre class="r"><code>dir()</code></pre>
</div>
<div id="workspace" class="section level2">
<h2><span class="header-section-number">1.3</span> Workspace</h2>
<p>You can list all objects in your workspace by typing <code>ls()</code>.</p>
<pre class="r"><code>ls()</code></pre>
<p>Probably you workspace does not list any objects yet. We can remove objects from the workspace using <code>rm()</code>.</p>
<pre class="r"><code>x &lt;- 20
y &lt;- 30
z &lt;- 40

ls()

rm(x) # removes one or more objects

rm(list=ls()) #removes all objects from workspace</code></pre>
</div>
<div id="load-and-install-packages" class="section level2">
<h2><span class="header-section-number">1.4</span> Load and install packages</h2>
<p>There are thousands of additional packages available for R. You can see the list of installed packages by typing: <code>library()</code></p>
<p>The same command is used for loading a specific package into the workspace = make it available for this session:</p>
<pre class="r"><code># loads the package raster:
library(raster)
# removes package from current workspace:
detach(package:raster)</code></pre>
<p>If you don’t have the packages above, install them in the package manager or by running</p>
<pre class="r"><code>install.packages(&quot;raster&quot;, dependencies=T)</code></pre>
</div>
<div id="getting-help" class="section level2">
<h2><span class="header-section-number">1.5</span> Getting help</h2>
<p>R comes with an extensive, built-in help system, and several manuals, help pages for every available function and many additional documents.</p>
<p>You can access the built-in manuals by typing:</p>
<pre class="r"><code>help.start()</code></pre>
<p>Help pages for specific functions can be accessed with help() or with abbreviation ?.</p>
<pre class="r"><code># help page for arithmetic mean:
help(mean)
# the same:
?mean</code></pre>
<p>Most functions come with examples:</p>
<pre class="r"><code>example(mean)</code></pre>
<p>Some function calls need to be surrounded by quotation marks when calling help, e.g. special characters or expression with syntactic meaning such as if, for und function.</p>
<pre class="r"><code>?&quot;*&quot;
?&quot;if&quot;</code></pre>
<p>If you have forgotten the exact name of a function, you can search all function names, titles and keywords by typing:</p>
<pre class="r"><code>help.search(&quot;mean&quot;)
# the same:
??mean</code></pre>
<p>Search through all (installed) functions that contain the word in their function call:</p>
<pre class="r"><code>apropos(&quot;mean&quot;)</code></pre>
<p>Look at all functions contained in any package by typing:</p>
<pre class="r"><code>library (help = base)</code></pre>
<p>Some package authors offer additional documents or tutorials called vignettes:</p>
<pre class="r"><code># list all available vignettes of the installed(!) packages:
vignette()

# opens the vignette as pdf:
vignette(&quot;Raster&quot;)</code></pre>
</div>
</div>
<div id="operators-and-objects" class="section level1">
<h1><span class="header-section-number">2</span> Operators and Objects</h1>
<div id="operators" class="section level2">
<h2><span class="header-section-number">2.1</span> Operators</h2>
<p>You can use R as simple calculator. Simply type in the expressions; they will be executed immediately.</p>
<pre class="r"><code>1+2*3
(1+2) * 3
2 * 5 - prod (2,5)
sqrt(25^2)
sin(pi/2)
0/0</code></pre>
<p>Check out <code>?Syntax</code> to learn about the precedence of operators. If in doubt (or simply for better overview) use round brackets.</p>
<p>Useful arithmetic operators:</p>
<ul>
<li><code>^</code> or <code>**</code>: power</li>
<li><code>*</code> / <code>/</code> : multiplication / division</li>
<li><code>+</code> / <code>-</code> : addition / subtraction</li>
<li><code>%/%</code> / <code>%%</code> : integer division / modulo</li>
</ul>
<p>Useful mathematic functions:</p>
<ul>
<li><code>max()</code>, <code>min()</code>, <code>range()</code> : extreme values</li>
<li><code>abs()</code> : absolute values</li>
<li><code>sqrt()</code> : square root</li>
<li><code>round()</code>, <code>floor()</code>, <code>ceiling()</code> : round</li>
<li><code>sum()</code>, <code>prod()</code> : sum, product</li>
<li><code>log()</code>, <code>log10()</code>, <code>log2()</code> : logarithm</li>
<li><code>exp()</code> : exponential function</li>
<li><code>sin()</code>, <code>cos()</code>, <code>tan()</code>, <code>asin()</code>, <code>acos()</code>, <code>atan()</code> : trigonometric functions</li>
</ul>
<p>Numeric constants:</p>
<ul>
<li><code>pi</code> : the number <span class="math inline">\(\pi\)</span></li>
<li><code>Inf</code>, <code>-Inf</code> : infinity</li>
<li><code>NaN</code> : not defined (<em>not a number</em>)</li>
<li><code>NA</code> : Missing value (<em>not available</em>)</li>
<li><code>NULL</code> : empty value</li>
</ul>
</div>
<div id="variablesobjects" class="section level2">
<h2><span class="header-section-number">2.2</span> Variables/Objects</h2>
<p>In principle, all data structures and functions are objects in R. You can get a list with all objects contained in the current workspace by typing:</p>
<pre class="r"><code>ls()</code></pre>
<p>We can assign own objects using the assignment operator/arrow <code>&lt;-</code>.</p>
<pre class="r"><code>x &lt;- seq(1,5)</code></pre>
<p>The results of any operation assigned to an object are usually not printed in the console. If you want to see the results in real time, simply enclose the entire command in brackets:</p>
<pre class="r"><code>(x &lt;- seq(1,5))</code></pre>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<p>R is case sensitive. X is not the same as x.</p>
<pre class="r"><code>X=1
ls()</code></pre>
<p><em><strong>Naming variables/objects:</strong></em></p>
<p>There is no single naming convention in R. Even in the same package, multiple conventions might be used <em>simultaneously</em>. But usually, it’s advisable to stay consistent. Basically, thera are <a href="https://www.r-bloggers.com/consistent-naming-conventions-in-r/">five naming conventions</a> to chose from:</p>
<ul>
<li>alllowercase: <em>e.g.</em> <code>adjustcolor</code></li>
<li>period.separated: <em>e.g.</em> <code>plot.new</code></li>
<li>underscore_separated: <em>e.g.</em> <code>numeric_version</code></li>
<li>lowerCamelCase: <em>e.g.</em> <code>addTaskCallback</code></li>
<li>UpperCamelCase: <em>e.g.</em> <code>SignatureMethod</code></li>
</ul>
<p>Despite this freedom of choice, there are also some rules. Object names have to begin with a letter and may not contain any special characters except dots (.) and underscores (_). Also be careful not to use names of built-in functions and constants (nothing bad will happen, it may just create confusion), <em>e.g.</em> <code>c()</code>, <code>t()</code>, <code>F</code>, <code>TRUE</code>, <code>pi</code>. Reserved words can be found here:</p>
<pre class="r"><code>?Reserved</code></pre>
</div>
<div id="logic" class="section level2">
<h2><span class="header-section-number">2.3</span> Logic</h2>
<p>Relational and logical operators are mainly relevant for complex data requests or manipulations, and for programming, e.g. in control flows.</p>
<p>Relations:</p>
<pre class="r"><code>?Comparison
4 &lt; 3
(1 + 3)!=3</code></pre>
<p>Logical constants and operations:</p>
<pre class="r"><code>?Logic
FALSE &amp;&amp; TRUE
TRUE || FALSE
FALSE || FALSE
(3 &lt; 2) &amp;&amp; (4 == (2^2))</code></pre>
<p>Examples help understanding the difference between the operators <code>&amp;&amp;</code> resp. <code>||</code> and <code>&amp;</code> resp. <code>|</code>. The shorter form performs elementwise comparisons in much the same way as arithmetic operators. The longer form evaluates left to right examining only the first element of each vector. Evaluation proceeds only until the result is determined. The longer form is appropriate for programming control-flow and typically preferred in if clauses.</p>
<pre class="r"><code>c(TRUE,TRUE) # c() means &#39;concatenate&#39; and combines arguments into a vector
c(TRUE,TRUE) &amp; c(FALSE, TRUE)
c(TRUE,TRUE) &amp; c(TRUE,FALSE)
c(TRUE,TRUE) &amp;&amp; c(TRUE,FALSE) # only first elements compared
c(TRUE,TRUE) &amp;&amp; c(FALSE,TRUE)</code></pre>
<p>Internally, <code>TRUE</code> is coded as 1 and <code>FALSE</code> as 0. Hence, you can also calculate with logical values. You will learn to appreciate it when doing data manipulations later on.</p>
<pre class="r"><code>x &lt;- c(3,5,1,-4,0,-2,4) # creates vector x
x &lt; 0 # which element of x is smaller than 0?
sum(x &lt; 0) # How many elements of x are smaller than 0?</code></pre>
<p>Relational operators:</p>
<ul>
<li><code>==</code>, <code>!=</code> : equal, unequal</li>
<li><code>&gt;</code>, <code>&gt;=</code> : greater than, greater or equal</li>
<li><code>&lt;</code>, <code>&lt;=</code> : smaller than, smaller or equal</li>
<li><code>!</code> : negation</li>
</ul>
</div>
<div id="basic-data-types" class="section level2">
<h2><span class="header-section-number">2.4</span> Basic data types</h2>
<p>R distinguishes five basic (atomic) data types:</p>
<p><em>Character:</em></p>
<pre class="r"><code>(first_name &lt;- &quot;Damaris&quot;)</code></pre>
<p><em>Integer:</em></p>
<pre class="r"><code>(shoe_size &lt;- 41)</code></pre>
<p><em>Numeric:</em></p>
<pre class="r"><code>(working_hours &lt;- 39.4)</code></pre>
<p><em>Factor:</em></p>
<pre class="r"><code>(lunch_today &lt;- factor(&#39;mensa&#39;,levels=c(&#39;mensa&#39;,&#39;bakery&#39;,&#39;chinese&#39;)))</code></pre>
<p><em>Boolean:</em></p>
<pre class="r"><code>(married &lt;- TRUE)</code></pre>
</div>
<div id="missing-values-na" class="section level2">
<h2><span class="header-section-number">2.5</span> Missing values NA</h2>
<p><code>NA</code> (Not Available) indicates missing values. For example, imagine a dataset with daily weather measurements over a longer period of time. On one day, the batteries of the weather station were empty and no measurements were taken. For integrity reasons, this empty day will still be stored in the data set but will be assigned the missing value ‘NA’. Knowing about NAs in your data is important because per default all functions will return NA if your data include NA.</p>
<pre class="r"><code>mean(c(1,5,2,NA,10,4,NA,7))</code></pre>
<p>Fortunately, you can exclude NAs from most operations.</p>
<pre class="r"><code>mean(c(1,5,2,NA,10,4,NA,7),na.rm=T)</code></pre>
<p>You can test for NAs with <code>is.na()</code></p>
<pre class="r"><code>is.na(c(1,5,2,NA,10,4,NA,7))</code></pre>
</div>
<div id="data-structures-and-object-types" class="section level2">
<h2><span class="header-section-number">2.6</span> Data structures and object types</h2>
<p>R distinguishes several objects types that differ in complexity of data structure: scalars and vectors, matrices, arrays, data frame and list. Vectors, matrices and arrays can only contain a single data type. Data frames can contain different data types in separate columns but all columns need to have the same length. Lists can contain different object types and data types.</p>
<p><img src="figures/Object_types.png" width="45%" /></p>
<p><em><strong>Vectors:</strong></em></p>
<p>There are many different ways to generate vectors in R. We have already learned concatenating <code>c()</code>.</p>
<p><em>Sequences:</em></p>
<pre class="r"><code>1:5
5:1
seq(5,10,by=.5)
seq(5,10,length=21)
seq_len(5)</code></pre>
<p><em>Replicates:</em></p>
<pre class="r"><code>rep(2,10)
rep(c(1,6,5),2)
rep(c(1,6,5),each=2)</code></pre>
<p><em><strong>Matrices:</strong></em></p>
<pre class="r"><code>(x_mat &lt;- matrix(1:4,2))
x_mat[2,1]
matrix(1:4,2,byrow=T)</code></pre>
<p><em><strong>Array:</strong></em></p>
<pre class="r"><code>(x_arr &lt;- array(1:24,c(4,3,2)))
x_arr[3,2,2]</code></pre>
<p><em><strong>Data frame:</strong></em></p>
<pre class="r"><code>(gcib_schedule &lt;- data.frame(weeks=1:16,
    fun_factor=sample(c(&#39;super&#39;,&#39;ok&#39;,&#39;pain&#39;),16,replace=T)))
gcib_schedule[1,]</code></pre>
<p>In data frames (and lists) we can access columns using the <code>$</code>-operator.</p>
<pre class="r"><code>gcib_schedule$weeks</code></pre>
<p><em><strong>Lists:</strong></em></p>
<pre class="r"><code>(gcib_course &lt;- list(course_name=&quot;Global Change Impacts on Biodiversity&quot;,
    module=&quot;M8&quot;, master_programme=&quot;Global Change Geography&quot;,
    semester=3, instructors=c(&#39;Zurell&#39;,&#39;Fandos&#39;),
    lessons= gcib_schedule))
gcib_course[1]
gcib_course[[1]]
gcib_course[&#39;lessons&#39;]
gcib_course[[&#39;lessons&#39;]]$weeks</code></pre>
</div>
<div id="indexing" class="section level2">
<h2><span class="header-section-number">2.7</span> Indexing</h2>
<p>Each element of an object type is internally assigned an index (positive integer ‘address’) and you can retrieve single elements or a subset of the object by addressing these indices. Square brackets are used for indexing.</p>
<pre class="r"><code>x[3] # retrieve the 3rd element of vector x
x[3:4] # use can also address sequences</code></pre>
<p>Basically, we distinguish four kinds of index vector: logical, positive integer, negative integer for excluding elements (inverse indexing), and character indices if we have named vectors.</p>
<pre class="r"><code>(x2 &lt;- c(x,NA))
x2[!is.na(x2)] # logical index vector
x2[c(1,3:4)] # index vector with positive integers
x2[-c(1,3:4)] # index vector with negative integers
(Fruits &lt;- c(Orange=5, Banana=10, Apple=1, Pear=20))
(Grocery &lt;- Fruits[c(&quot;Orange&quot;,&quot;Apple&quot;)]) # character index</code></pre>
<p>You can also modify single elements.</p>
<pre class="r"><code>Fruits[&quot;Banana&quot;] &lt;- 0</code></pre>
</div>
<div id="object-structures" class="section level2">
<h2><span class="header-section-number">2.8</span> Object structures</h2>
<p>Use <code>str()</code> for displaying the object structure.</p>
<pre class="r"><code>str(x_mat)
str(x_arr)
str(gcib_schedule)
str(gcib_course)</code></pre>
<p>The character vector ‘fun_factor’ in <code>gcib_schedule</code> was automatically converted to factors. This is ok here, but one may want to change this behaviour for other purposes. See the help page <code>?data.frame</code> to find out how.</p>
</div>
</div>
<div id="loops-and-functions" class="section level1">
<h1><span class="header-section-number">3</span> Loops and functions</h1>
<div id="control-flows" class="section level2">
<h2><span class="header-section-number">3.1</span> Control flows</h2>
<p>Control-flow constructs are among the most important <em>building blocks</em> in programming because they help structuring the workflow. We use loops for repeating workflows, and conditional expressions and switch statements for making choices between alternative control flows based on some conditions.</p>
<div id="if-else-ifelse" class="section level3">
<h3><span class="header-section-number">3.1.1</span> If, else, ifelse</h3>
<p>We use conditional expressions if specific computations and actions should only be performed under certain conditions. R knows three conditional expressions:</p>
<ul>
<li><code>if(condition){command block}</code></li>
<li><code>if(condition){command block} else{alternative command block}</code></li>
<li><code>ifelse(condition, command block, alternative command block)</code></li>
</ul>
<p>These functions always require a Boolean condition, meaning that it needs to evaluate to <code>TRUE</code> or <code>FALSE</code>. Single commands do not need to be surrounded by curly brackets. Still, for beginners, they facilitate overview. Conditional expressions may be nested.</p>
<pre class="r"><code>number &lt;- 12

if (number &lt; 12) {
  print(&#39;This number is smaller than 12.&#39;)
} else 
    if (number==12) {
      print(&#39;This number is equal to 12.&#39;)
    } else {
        print(&#39;This number is greater than 12.&#39;)
      }</code></pre>
<pre><code>## [1] &quot;This number is equal to 12.&quot;</code></pre>
<p>The function <code>ifelse()</code> allows elementwise evaluation of the condition.</p>
<pre class="r"><code>x &lt;- 5
ifelse (x %in% c(5,6), TRUE, FALSE)</code></pre>
<p><code>ifelse()</code> is most useful for evaluating elements of a vector according to a specific condition.</p>
<pre class="r"><code>(x&lt;-sample(1:20,30,replace=T))
ifelse(x&lt;=10,0,1)</code></pre>
</div>
<div id="switch" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Switch</h3>
<p>We can distinguish species cases by using <code>switch()</code>. This compares a given value with specified constants and takes action according to the first constant to match. The expression/condition can also be numeric, in this case it refers to the index of the different case alternatives. If the alternatives are named, they can be called by these names. If no case matches, then the empty value <code>NULL</code> is returned.</p>
<pre class="r"><code>switch(2,a=11,b=12,cc=13,d=14)</code></pre>
<pre><code>## [1] 12</code></pre>
<pre class="r"><code>switch(&quot;c&quot;,a=11,b=12,cc=13,d=14)
switch(&quot;cc&quot;,a=11,b=12,cc=13,d=14)</code></pre>
<pre><code>## [1] 13</code></pre>
<p><span class="citation">Crawley (2007)</span> (p. 63) provides a nice how <code>switch()</code> can be used in functions.</p>
<pre class="r"><code>central &lt;- function(y, measure) { 
  switch(measure, 
         Mean = mean(y), 
         Geometric = exp(mean(log(y))), 
         Harmonic = 1/mean(1/y), 
         Median = median(y), 
         stop(&quot;Measure not included&quot;)) 
  }

central(rnorm(100,10,2),&quot;Harmonic&quot;)</code></pre>
<pre><code>## [1] 9.554432</code></pre>
<pre class="r"><code>central(rnorm(100,10,2),4)</code></pre>
<pre><code>## [1] 10.27465</code></pre>
</div>
</div>
<div id="loops" class="section level2">
<h2><span class="header-section-number">3.2</span> Loops</h2>
<p>You will often here that loops should be avoided in R codes wherever possible as they tend to make your codes slower. Nevertheless, they are an important element in programming. We use them, for example, for iterating (parts of) programs with different parameters or initial values. R offers three different loop structures: <code>repeat</code>, <code>while</code> and <code>for</code>, the latter probably being the most commonly used.</p>
<div id="repeat" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Repeat</h3>
<p>The <code>repeat</code> loop is the most simplest but maybe also the most dangerous loop structure. If you do not set an appropriate stop criterium (using <code>break</code>), the loop will iterate forever.</p>
<pre class="r"><code>i &lt;- 0 
repeat{
  i &lt;- i+1 
  print(i) 
  if(i&gt;=10) break
  }</code></pre>
<p>The control word <code>next</code> halts the processing of the current iteration step and advances the looping index.</p>
<pre class="r"><code>i &lt;- 0 
repeat{
  i &lt;- i+1 
  if(i&gt;=3 &amp; i&lt;=8) next 
  print(i)
  if (i&gt;=10) break
  }</code></pre>
</div>
<div id="while" class="section level3">
<h3><span class="header-section-number">3.2.2</span> While</h3>
<p>The <code>while</code> loop is a little safer than <code>repeat</code> because the break condition is already provided in the function call. Thus, in the while loop, a command block is iterated until the final condition is fulfilled.</p>
<pre class="r"><code>i &lt;- 0
while (i&lt;=10) {
  i &lt;- i + 1
}</code></pre>
<p>Both control words <code>break</code> and <code>next</code> will also work in <code>while</code> loops.</p>
</div>
<div id="for" class="section level3">
<h3><span class="header-section-number">3.2.3</span> For</h3>
<p>The <code>for</code> loop iterates through all elements of a provided vector: <code>for (i in M) {command block}</code>. See the help page <code>?&quot;for&quot;</code>.</p>
<pre class="r"><code>x &lt;- c(3,6,2,5,10)

for (i in x) {
  print(i^2)
}</code></pre>
</div>
</div>
<div id="functions" class="section level2">
<h2><span class="header-section-number">3.3</span> Functions</h2>
<p>R and the contributed packages contain a myriad of built-in functions. Still, it might be useful to write your own functions at some point. For example, you can combine a number of consecutive commands under one name/function. This facilitates recurring computations and improves clarity of your scripts.</p>
<p>Function definitions always start with <code>function()</code> followed by a command block in curly brackets <code>{}</code>. Obligatory and optional arguments are defined in the round brackets (). You can define arguments with and without default settings, and the argument list may also be emtpy.</p>
<pre class="r"><code># function without arguments:
greetings &lt;- function(){
    print(&#39;Hello world&#39;)
    }
greetings()

# function with obligatory argument without default:
greetings &lt;- function(name){
    print(paste(&#39;Hello&#39;,name))
    }
greetings(&#39;students&#39;)

#function with one obligatory argument and another argument with default
greetings &lt;- function(name,greet=&#39;Hello&#39;){
    print(paste(greet,name))
    }
greetings(&#39;students&#39;)
greetings(&#39;students&#39;,&#39;Wake up&#39;)</code></pre>
<div id="anonymous-functions" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Anonymous functions</h3>
<p>We can also provide anonymous functions, which are not named. These are useful, for example, in commands like <code>apply()</code>, <code>aggregate()</code> etc. Anonymous means that these function are not assigned to an object name but only used once upon definition. An example from <span class="citation">Crawley (2007)</span>:</p>
<pre class="r"><code>(function(x,y){ z &lt;- 2*x^2 + y^2; x+y+z })(0:7, 1)</code></pre>
</div>
</div>
</div>
<div id="data-import-and-export" class="section level1">
<h1><span class="header-section-number">4</span> Data import and export</h1>
<p>R offers several options for accessing different data formats. Standard formats include text files (in ASCII format), binary files, R files (single objects or entire workspaces), and databases. These data can be read in from files using a file path, but also from the Internet using an URL path or from the clipboard. Of course, you can also write to these same devices. A good over view is provided in the manual „R Data Import/Export“ (R Development Core Team 20xx), which you can access by typing help.start(). The manual also contains information on some useful packages, e.g. foreign, which provides access to datasets created with different statistical software such as SAS, SPSS, S-PLUS etc. Data import using the package <code>tidyverse</code> is briefly explained in the <a href="https://www.rstudio.com/resources/cheatsheets/">RStudio cheat sheets</a>.</p>
<div id="write-text-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Write text data</h2>
<p>All objects created in R can be exported to file. Data frame can be written to file by <code>write.table</code> and its variants:</p>
<pre class="r"><code>write.table(gcib_schedule,&quot;myData.txt&quot;, row.names=F, col.names=T, sep=&#39;,&#39;)
write.csv(gcib_schedule,&quot;myData.csv&quot;)</code></pre>
<p>Important arguments: - <code>file</code>: (path) and file name - <code>sep</code>: column separator. Default: &quot; &quot; (white space or tab) - <code>dec</code>: character used for decimal points. Default: “.”</p>
<p>The function <code>write()</code> allows writing vectors and matrices to file. However, it contains some surprising default settings. Check out the help pages and below example. For demonstration purpose, we pipe the output into the console (&quot;&quot;).</p>
<pre class="r"><code># Write vector:
write(x,&quot;&quot;)
write(1:1000,file=&quot;myColumn.txt&quot;)

# Write matrix:
(Xmat &lt;- matrix(1:10,ncol=5))
write(Xmat,&quot;&quot;)</code></pre>
<p>Surprisingly, the matrix is not exported in the right structure. Check out the help page <code>?write</code> to find out more about it.</p>
<pre class="r"><code># transpose matrix before exporting: works!
write(t(Xmat),&quot;&quot;)</code></pre>
</div>
<div id="read-text-data" class="section level2">
<h2><span class="header-section-number">4.2</span> Read text data</h2>
<p>List all files in your folder by typing:</p>
<pre class="r"><code>list.files()

# alternative that also lists folders:
dir()</code></pre>
<p>The data file <code>myData.txt</code> is in table format (data frame); every column has a name, and columns are separated by comma. This information is important for correct reading:</p>
<pre class="r"><code>my_df &lt;- read.table(&#39;myData.txt&#39;)</code></pre>
<p>There may be several reasons for an error message. Is the data table correct? Do all columns contain the same number of elements? Yes, the data file is correct. Then, it probably has to do with the arguments passed to <code>read.table()</code>. Have a look at the help page and the default settings.</p>
<p>Important arguments: - <code>file</code>: (path) and file name - <code>header</code>: logical value indicating wether file contains column names; defaults to <code>FALSE</code> - <code>sep</code>: column separator. Default: &quot; &quot; (white space or tab) - <code>dec</code>: character used for decimal points. Default: “.” - <code>colClasses</code>: optional vector giving data types for each column - <code>stringsAsFactors</code>: set to <code>FALSE</code> to avoid automatic transformation of character to factor.</p>
<p>R expects white spaces as field separator but we had separated our data columns by comma when saving the file. Also, R does not assume column names. So, we have to tell R. correct reading:</p>
<pre class="r"><code>(my_df &lt;- read.table(&#39;myData.txt&#39;, sep=&#39;,&#39;, header=T))
str(my_df)
names(my_df)
summary(my_df)</code></pre>
<p>There are also some useful modifications for common formats, e.g. for comma-separated files (csv):</p>
<pre class="r"><code>read.csv(&#39;myData.txt&#39;)
read.csv(&#39;myData.csv&#39;)</code></pre>
<p>Sometimes, using read.table() or its modifications is not meaningful. The next example file does not contain a data table but only a (very long) vector. <code>read.table()</code> will still work but it will be slow, and will create a data frame object with many rows in only one column, which is not very sensible.</p>
<pre class="r"><code>read.table(&quot;myColumn.txt&quot;)</code></pre>
<p>For such one-row or one-column data files, it is better to use functions like <code>scan()</code>. With some exercise, this command can also be used for reading very complex data structures.</p>
<pre class="r"><code>scan(&quot;myColumn.txt&quot;)</code></pre>
<p>Other packages are available that provide more convenient functions for data import, e.g. <code>tidyverse</code> or <code>data.table</code>. Often, these functions will automatically detect the data structure in the files.</p>
<pre class="r"><code>library(tidyverse)
read_delim(&quot;myData.txt&quot;)

# so, read_delim does not detect the column separator
read_delim(&quot;myData.txt&quot;,delim=&#39;,&#39;)
read_csv(&quot;myData.txt&quot;)

library(data.table)
fread(&#39;myData.txt&#39;)</code></pre>
</div>
<div id="read-and-write-r-objects" class="section level2">
<h2><span class="header-section-number">4.3</span> Read and write R objects</h2>
<p>A very useful option is to save R objects (<code>save()</code>) or the entire workspace (<code>save.image()</code>). With the latter, you can simply continue an R session at any later time. Saving single objects may be useful, for example, for saving statistical models that were estimated and analysed but that you want to keep for later references, for repeating some analyses etc.</p>
<pre class="r"><code># save object Xmat
save(Xmat,file=&quot;Xmat.Rdata&quot;)</code></pre>
<p>You can load R objects or workspaces using <code>load()</code>.</p>
<div class="alert alert-info">
<p><em><strong>Exercise:</strong></em></p>
<p>Save the entire workspace as <code>“Day1.RData”</code> and quit R (e.g. by typing <code>quit()</code> or <code>q()</code>). Open a new R session and load workspace „Day1“. All data should be available again.</p>
</div>
</div>
<div id="read-script-files" class="section level2">
<h2><span class="header-section-number">4.4</span> Read script files</h2>
<p>As mentioned earlier, you can also load and execute complete script files. This is useful, for example, when you have several self-defined functions in a separate file and you want to make them available for the current session. You can use the function <code>source()</code> for this.</p>
</div>
</div>
<div id="data-wrangling-base-r-and-tidyverse" class="section level1">
<h1><span class="header-section-number">5</span> Data wrangling (base R and tidyverse)</h1>
<p>I usually read, manipulate and write my data using the base R functions. A lot of the data cleaning and manipulation needs some experience though. I suppose this is where <code>dplyr</code> and <code>tidyr</code> come into play. I will introduce/recap them here, but during most of the course you will catch me using the base functions.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<p>We read in a data set on breeding birds in Connecticut between 2011-2014 originating from the North American Breeding Bird Survey (BBS). Download the file <a href="/files/CT.csv">here</a> and put it into your working directory. First, we read the file using R base functions, then we compare to <code>tidyverse</code> utilities.</p>
<pre class="r"><code># base R:
birdsCT &lt;- read.csv(&quot;CT.csv&quot;,header=T)
head(birdsCT)
# check data structure:
str(birdsCT)

# read_csv() uses tidyverse package `readr`, and prints column specifications
birdsCT_tb &lt;- read_csv(&quot;CT.csv&quot;)
head(birdsCT_tb)
birdsCT_tb

# check data structure:
glimpse(birdsCT_tb)</code></pre>
<div id="extract-data" class="section level2">
<h2><span class="header-section-number">5.1</span> Extract data</h2>
<p><em>Important <code>dplyr</code> verbs:</em></p>
<ul>
<li><code>select()</code>: select columns</li>
<li><code>filter()</code>: filter rows</li>
<li><code>arrange()</code>: re-order or arrange rows</li>
<li><code>mutate()</code>: create new columns</li>
<li><code>summarise()</code>: summarise values</li>
<li><code>group_by()</code> allows for group operations in the “split-apply-combine” concept</li>
</ul>
<p><em>Some additional options:</em></p>
<ul>
<li><code>&quot;-&quot;</code>: Select everything but</li>
<li><code>&quot;:&quot;</code>: Select range</li>
<li><code>contains()</code>: Select columns whose name contains a character string</li>
<li><code>ends_with()</code>: Select columns whose name ends with a string</li>
<li><code>everything()</code>: Select every column</li>
<li><code>matches()</code>: Select columns whose name matches a regular expression</li>
<li><code>num_range()</code>: Select columns named x1, x2, x3, x4, x5</li>
<li><code>one_of()</code>: Select columns whose names are in a group of names</li>
<li><code>starts_with()</code>: Select columns whose name starts with a character string</li>
</ul>
<p><em><strong>Selecting columns:</strong></em> Select only the columns year, Latin.name, Latitude and Longitude:</p>
<pre class="r"><code># dplyr
select(birdsCT_tb, year, Latin.name, Latitude, Longitude)

# base R
head(birdsCT[,c(&#39;year&#39;, &#39;Latin.name&#39;, &#39;Latitude&#39;, &#39;Longitude&#39;)])</code></pre>
<p>Select all columns except year:</p>
<pre class="r"><code># dplyr
select(birdsCT_tb, -year)

# base R
head(birdsCT[,!names(birdsCT)%in%&#39;year&#39;])</code></pre>
<p>Select all columns containing the string “Stop”:</p>
<pre class="r"><code># dplyr
select(birdsCT_tb, contains(&#39;Stop&#39;))

# base R
head(birdsCT[,grep(&#39;Stop&#39;,names(birdsCT))])</code></pre>
<p>You can also rename column names for your <code>select()</code> output. It won’t affect the actual data frame. Here, I must admit that I don’t know a quick and easy version in base R. Any code to do that would certainly be more complicated.</p>
<pre class="r"><code>head(select(birdsCT_tb, year, Latin.name, Lat=Latitude, Lon=Longitude))
head(birdsCT_tb)</code></pre>
<p><em><strong>Selecting rows:</strong></em></p>
<p>Filter all records from year 2012:</p>
<pre class="r"><code># dplyr
filter(birdsCT_tb, year==2012)
filter(birdsCT_tb, year==2012 | year==2013)

# base R
head(subset(birdsCT, year==2012))
head(subset(birdsCT, year==2012 | year==2013))</code></pre>
</div>
<div id="manipulate-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Manipulate data</h2>
<p><em><strong>Mutate: Derive new variables using <code>mutate()</code>:</strong></em></p>
<p>Add columns (not to original data frame though!) with calculations based on other columns:</p>
<pre class="r"><code># dplyr
select(
    mutate(birdsCT_tb,occ=Stop1+Stop2),
        route.id,year,Latin.name,occ)

# dplyr bit more complicated
birdsCT_tb2 &lt;- select(
    birdsCT_tb %&gt;%
        mutate(route.occ =
            select(., contains(&#39;Stop&#39;)) %&gt;% rowSums(na.rm=TRUE)),
            route.id,year,Latin.name,route.occ)
birdsCT_tb2</code></pre>
<p>The last command involved <em>chaining</em> and used <code>%&gt;%</code> to pipe together several comments. This can be quite useful!</p>
<p>Could we do that with base R functions? Sure!</p>
<pre class="r"><code>head(data.frame(birdsCT[,c(&#39;route.id&#39;,&#39;year&#39;,&#39;Latin.name&#39;)],
    occ=rowSums(birdsCT[,c(&#39;Stop1&#39;,&#39;Stop2&#39;)])))

birdsCT2 &lt;- data.frame(birdsCT[,c(&#39;route.id&#39;,&#39;year&#39;,&#39;Latin.name&#39;)],
    route.occ=rowSums(birdsCT[,grep(&#39;Stop&#39;,names(birdsCT))]))
head(birdsCT2)</code></pre>
<p>To cut a long story short: you have to find your own way of doing things in R. R has always been and will continue to be anarchic …</p>
<p><em><strong>Analyse by group using <code>group_by()</code>:</strong></em></p>
<p>We can perform operations by <em>group</em>. For this, we will use our smaller summarised data frames from above and calculate for each species how many years each route was occupied. We only judge species as certainly breeding at the route if it has been recorded for at least two years.</p>
<pre class="r"><code># dplyr
birdsCT_breed_tb &lt;- filter(
    birdsCT_tb2 %&gt;%
        group_by(route.id,Latin.name) %&gt;%
            summarise(total.nr.years.occupied = sum(route.occ&gt;0)),
            total.nr.years.occupied&gt;1)
birdsCT_breed_tb</code></pre>
<p>And the same in base R?</p>
<pre class="r"><code># base R
birdsCT_breed &lt;- subset(
    aggregate(list(total.nr.years.occupied = birdsCT2[,&#39;route.occ&#39;]),
        by=list(Latin.name=birdsCT2$Latin.name,
            route.id= birdsCT2$route.id), FUN=function(x){sum(x&gt;0)}),
    total.nr.years.occupied&gt;1)
head(birdsCT_breed)</code></pre>
<p>Often, the dplyr way is faster but not always; there are also many different ways to do things in dplyr and their speed will vary. Check out the time the above commands need by using <code>system.time()</code>.</p>
<p>Also, there are other packages that enhance the base R functions, e.g. the package <code>data.table</code>.</p>
</div>
<div id="join-data" class="section level2">
<h2><span class="header-section-number">5.3</span> Join data</h2>
<p>When processing data, it is often necessary to join/merge different data sets. For example, we now have a data frame containing all routes and bird species found in Connecticut for the years 2011-2014. Additionally, we created a data frame containing for each bird species only those routes that have been occupied for at least two years during the observation period. However, the latter does not contain information on route coordinates among others. This can be amended by simply joining both data frames.</p>
<p>The dplyr functions for joining are: - <code>left_join(a, b, by = &quot;x1&quot;)</code>: Join matching rows from b to a. Entries in b that have no matching entry in a will be ignored. Extra rows will be added in cases where entries of a are not contained in b. - <code>right_join(a, b, by = &quot;x1&quot;)</code>: Join matching rows from a to b. Entries in a that have no matching entry in b will be ignored. Extra rows will be added in cases where entries of b are not contained in a. - <code>inner_join(a, b, by = &quot;x1&quot;)</code>: Retain only rows in both sets. Entries without matching will be ignored. - <code>full_join(a, b, by = &quot;x1&quot;)</code>: Join data. Retain all values, all rows. Extra rows will be added to the output for all non-matching entries.</p>
<pre class="r"><code>birdsCT_final_tb  &lt;- select(birdsCT_tb, route.id, countrynum,
    statenum, Route, Latitude, Longitude) %&gt;%
        distinct(.) %&gt;%
            right_join(., birdsCT_breed_tb, by=&#39;route.id&#39;)

birdsCT_final_tb</code></pre>
<p>The base R function for joining in <code>merge()</code>.</p>
<pre class="r"><code>birdsCT_final &lt;- merge(
    birdsCT[
        !duplicated(birdsCT[,c(&#39;route.id&#39;, &#39;countrynum&#39;, &#39;statenum&#39;,
            &#39;Route&#39;,&#39;Latitude&#39;,&#39;Longitude&#39;)]),
        c(&#39;route.id&#39;,&#39;countrynum&#39;,&#39;statenum&#39;,&#39;Route&#39;,&#39;Latitude&#39;,&#39;Longitude&#39;)],
    birdsCT_breed, by=&#39;route.id&#39;)

birdsCT_final</code></pre>
</div>
<div id="family-apply" class="section level2">
<h2><span class="header-section-number">5.4</span> Family <code>apply</code></h2>
<p>If you want to do complex operations on matrices, data frames or lists, <code>apply()</code> and its derivates are most often the tool of choice as they run a lot faster than loops. This is what is often term <em>vectorizing</em> your code.</p>
<p><code>apply()</code> allows row-wise and column-wise execution of functions over matrices, data.frames and arrays. Thereby, the argument <code>MARGIN</code> refers to the dimension you want the operation to run over (1 means row-wise, 2 column-wise). Also you have to provide an argument <code>FUN</code> that specifies which function you want to run over the array. In the following examples, we calculate the mean.</p>
<pre class="r"><code>(Xmat=matrix(1:12,nrow=4)) 

apply(Xmat,1,mean) 
rowMeans(Xmat) #identical 

apply(Xmat,2,mean) 
colMeans(Xmat) #identical</code></pre>
<p>You can also define own <em>anonymous</em> functions in the form <code>FUN=function(x){...}</code>.</p>
<pre class="r"><code>(Xdf &lt;- data.frame(x=rep(1,10), y=rep (3,10)))

apply(Xdf,1,FUN=function(x){sum(x)^2}) </code></pre>
<p>^Also check out `<code>lapply()</code> and <code>sapply()</code> that are useful functions for operations over vectors or lists.</p>
</div>
</div>
<div id="visualising-data-base-r-and-ggplot2" class="section level1">
<h1><span class="header-section-number">6</span> Visualising data (base R and ggplot2)</h1>
<div id="base-graphics" class="section level2">
<h2><span class="header-section-number">6.1</span> Base graphics</h2>
<p>R has many base functions for plotting graphics. So-called <em>high-level</em> graphic functions produce complete, independent graphics such as boxplots, histograms or scatterplots along with axes labels and titles. You can modify these according to your needs by optional arguments, e.g. labels, line widths, point symbols, colours.</p>
<p>Let’s first create some data for visualisation:</p>
<pre class="r"><code>height &lt;- rnorm(200,mean=180,sd=10)
pop &lt;- data.frame(height=height, weight=-60+height*0.8+rnorm(200,sd=15),
    age=rpois(200,42), sex=sample(c(&#39;F&#39;,&#39;M&#39;),200,replace=T))</code></pre>
<p>Now, make very simple scatterplots</p>
<pre class="r"><code># explicitly provide x and y axis
plot(x=pop$height, y=pop$weight)

# formula method
plot(weight~height, data=pop)</code></pre>
<p>You can customize the plot with various options. See <code>?par</code> for options.</p>
<pre class="r"><code>plot(x=pop$height, y=pop$weight, pch=19, col=&#39;salmon&#39;,
    xlab=&#39;Body height [cm]&#39;, ylab=&#39;Body weight [km]&#39;,
    main=&#39;Relationship between body size and weight&#39;)</code></pre>
<p><img src="0_Intro_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>You can change the plot type using the <code>type</code> argument.</p>
<pre class="r"><code>plot(pop$height, type=&#39;l&#39;)</code></pre>
<p>Histograms and boxplots:</p>
<pre class="r"><code># open a new graphic device
# under Windows OS it should be &quot;windows()&quot;, under linux &quot;x11()&quot;
quartz(w=6,h=6)

hist(pop$height)
boxplot(pop$height~pop$sex)</code></pre>
<p>So-called <em>low-level</em> graphic functions let you add certain elements to existing plots, e.g. lines, labels, legends etc. Also, you can make mathematical annotations (<code>?plotmath</code>).</p>
<pre class="r"><code># Set the plot margin size; see &quot;?par&quot;
par(mar=c(5,4,4,4)+0.1)

plot(x=pop$height, y=pop$weight, pch=19, col=&#39;salmon&#39;,
    xlab=&#39;Body height [cm]&#39;, ylab=&#39;Body weight [km]&#39;,
    main=&#39;Relationship between body size and weight&#39;,
    ylim=c(0,max(pop$weight)))

# add regression line
abline(lm(pop$weight ~pop$height), col=&#39;salmon3&#39;, lwd=2)

# add points
points(x=pop$height, y=pop$age, pch=17, col=&#39;CornFlowerBlue&#39;)
abline(lm(pop$age ~pop$height), col=&#39;blue3&#39;, lwd=2)

# add axis for age
axis(4,at=pretty(range(pop$age)),col.axis=&#39;CornFlowerBlue&#39;)

# add axis label
mtext(&#39;Age&#39;,side=4,col=&#39;CornFlowerBlue&#39;, line=2.5)</code></pre>
<p><img src="0_Intro_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
</div>
<div id="plotting-with-ggplot2" class="section level2">
<h2><span class="header-section-number">6.2</span> Plotting with <code>ggplot2</code></h2>
<p><code>ggplot2</code> is a visualisation library that allows more elegant and versatile plotting. It follows quite a different philosophy than base graphics. Plots are built step by step. This basic template can be used for different types of plots:</p>
<p><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) +  &lt;GEOM_FUNCTION&gt;()</code></p>
<pre class="r"><code>library(ggplot2)</code></pre>
<p>The ggplot() function binds the plot to a specific data frame using the data argument.</p>
<pre class="r"><code>ggplot(data = pop)      # this provides a blank ggplot object</code></pre>
<p>Using the aesthetic function <code>aes()</code> we can define the geometric and statistical objects (color, size, shape, and position).</p>
<pre class="r"><code>p &lt;- ggplot(data = pop, mapping = aes(x = height, y = weight))</code></pre>
<p>Using the <code>geom_</code> functions, we can add the geometric shapes representing the data, e.g.: - <code>geom_point()</code> for scatter plots, dot plots, etc. - <code>geom_boxplot()</code> for boxplots - <code>geom_line()</code> for trend lines, time series, etc.</p>
<pre class="r"><code>p + geom_point()

# you can also do it in one go
ggplot(data = pop, mapping = aes(x = height, y = weight)) + geom_point()</code></pre>
<p>We can modify this plot by adding colours, transparency etc.</p>
<pre class="r"><code>p + geom_point(color=&#39;salmon&#39;)

# add transparency:
p + geom_point(color=&#39;salmon&#39;, alpha=0.5)

# assign different colours to females and males:
p + geom_point(aes(color=sex))

# assign different symbols to age classes:
p + geom_point(aes(color=sex, shape=factor(round(age/10)*10)))</code></pre>
<pre class="r"><code># assign different point sizes to age:
p + geom_point(aes(color=sex, size=age))</code></pre>
<p><img src="0_Intro_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>Add a linear model or Loess smoother:</p>
<pre class="r"><code># regression line:
p + geom_point() + geom_smooth(method=&quot;lm&quot;)</code></pre>
<pre class="r"><code># smoother:
p + geom_point() + geom_smooth(method=&quot;loess&quot;)</code></pre>
<p><img src="0_Intro_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<p>Boxplot:</p>
<pre class="r"><code>ggplot(data = pop, mapping = aes(x = sex, y = weight)) +
    geom_boxplot()</code></pre>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-crawley2007">
<p>Crawley, Michael J. 2007. <em>The R Book</em>. UK: John Wiley &amp; Sons.</p>
</div>
</div>
</div>

<!DOCTYPE html>
<html>

<br>
<hr />
<div id="footer">
<p>Damaris Zurell <a href="http://creativecommons.org/licenses/by/4.0/" >(CC BY 4.0)</a>.  </p>
</div>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
