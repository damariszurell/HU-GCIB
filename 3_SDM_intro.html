<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Introduction to SDMs: data preparation and simple model fitting</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">M8: Global change impacts on biodiversity</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Course schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="0_Intro.html">0. Introduction to R</a>
    </li>
    <li>
      <a href="1_Data.html">1. Biodiversity &amp; environmental data</a>
    </li>
    <li>
      <a href="2_patterns.html">2. Analyse biodiversity patterns</a>
    </li>
    <li>
      <a href="3_SDM_intro.html">3. SDMs: simple model fitting</a>
    </li>
    <li>
      <a href="4_SDM_eval.html">4. SDMs: assessment and prediction</a>
    </li>
    <li>
      <a href="5_SDM_algorithms.html">5. SDMs: algorithms</a>
    </li>
    <li>
      <a href="6_SDM_ensembles.html">6. SDMs: ensembles</a>
    </li>
    <li>
      <a href="7_SDM_conservation.html">7. SDMs: conservation applications</a>
    </li>
    <li>
      <a href="8_dispersal.html">8. Dispersal models</a>
    </li>
    <li>
      <a href="9_populations.html">9. Population dynamic models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:damaris@zurell.de">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://damariszurell.github.io">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ZurellLab">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to SDMs: data preparation and simple model fitting</h1>

</div>


<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>This session will introduce you to simple species distribution models (SDMs). Species distribution models (SDMs) are a popular tool in quantitative ecology <span class="citation">(Franklin 2010; Peterson et al. 2011; Guisan, Thuiller, and Zimmermann 2017)</span> and constitute the most widely used modelling framework in global change impact assessments for projecting potential future range shifts of species <span class="citation">(IPBES 2016)</span>. There are several reasons that make them so popular: they are comparably easy to use because many software packages <span class="citation">(e.g. Thuiller et al. 2009; Phillips, Anderson, and Schapire 2006)</span> and guidelines <span class="citation">(e.g. Elith, Leathwick, and Hastie 2008; Elith et al. 2011; Merow, Smith, and Silander Jr 2013; Guisan, Thuiller, and Zimmermann 2017)</span> are available, and they have comparably low data requirements.</p>
<p>SDMs relate biodiversity observations (e.g. presence-only, presence/absence, abundance, species richness) at specific sites to the prevailing environmental conditions at those sites. Different statistical and machine-learning algorithms are available for this. Based on the estimated biodiversity-environment relationship, we can make predictions in space and in time by projecting the model onto available environmental layers (Figure 1).</p>
<div class="figure">
<img src="figures/sdm.png" alt="**Figure 1. Schematic representation of the species distribution modelling concept. First, biodiversity and environmental information are sampled in geographic space. Second, a statistical model (here, generalised linear model) is used to estimate the species-environment relationship. Third, the species–environment relationship can be mapped onto geographic layers of environmental information to delineate the potential distribution of the species. Mapping to the sampling area and period is usually referred to as interpolation, while transferring to a different time period or geographic area is referred to as extrapolation.**" width="70%" />
<p class="caption">
<strong>Figure 1. Schematic representation of the species distribution modelling concept. First, biodiversity and environmental information are sampled in geographic space. Second, a statistical model (here, generalised linear model) is used to estimate the species-environment relationship. Third, the species–environment relationship can be mapped onto geographic layers of environmental information to delineate the potential distribution of the species. Mapping to the sampling area and period is usually referred to as interpolation, while transferring to a different time period or geographic area is referred to as extrapolation.</strong>
</p>
</div>
<p>We distinguish five main modelling steps for SDMs: (i) conceptualisation, (ii) data preparation, (iii) model fitting, (iv) model assessment, and (v) prediction (Figure 2.). The last step (prediction) is not always part of SDM studies but depends on the model objective. Generally, we distinguish three main objectives for SDMs: (a) inference and explanation, (b) mapping and interpolation, and (c) forecast and transfer. I recommend getting more familiar with critical assumptions and modelling decisions by studying the many excellent review articles <span class="citation">(Guisan and Zimmermann 2000; Guisan and Thuiller 2005; Elith and Leathwick 2009)</span> and textbooks on SDMs <span class="citation">(Peterson et al. 2011; Franklin 2010; Guisan, Thuiller, and Zimmermann 2017)</span>.</p>
<p>I would also like to emphasise that model building is an iterative process and there is much to learn on the way. In consequence, you may want to revisit and improve certain modelling steps, for example improve the spatial sampling design. Because of that I like to regard model building as a cycle rather than a workflow with a pre-defined termination point (Figure 2.).</p>
<div class="figure">
<img src="figures/sdm_steps.png" alt="**Figure 2. The main modelling cycle in species distribution modelling.**" width="50%" />
<p class="caption">
<strong>Figure 2. The main modelling cycle in species distribution modelling.</strong>
</p>
</div>
<div id="prac-overview" class="section level2">
<h2><span class="header-section-number">1.1</span> Prac overview</h2>
<p>For today, we will only work with Generalised Linear Models (GLMs) and concentrate on the first three model building steps (Figure 2.)</p>
</div>
<div id="generalised-linear-models-glms" class="section level2">
<h2><span class="header-section-number">1.2</span> Generalised linear models (GLMs)</h2>
<p>Why do we not simply use linear regression to fit our species-environment relationship? Well, strictly, ordinary least squares (OLS) linear regression is only valid if the response (or rather the error) is normally distributed and ranges (<span class="math inline">\(-\infty,\infty\)</span>). OLS regression looks like this</p>
<p><span class="math display">\[E(Y|X)=\beta X+\epsilon\]</span></p>
<p>where <span class="math inline">\(E(Y|X)\)</span> is the <em>conditional mean</em>, meaning the expected value of the response <span class="math inline">\(Y\)</span> given the environmental predictors <span class="math inline">\(X\)</span> <span class="citation">(Hosmer and Lemeshow 2013)</span>. <span class="math inline">\(X\)</span> is the matrix of predictors (including the intercept), <span class="math inline">\(\beta\)</span> are the coefficients for the predictors, and <span class="math inline">\(\epsilon\)</span> is the (normally distributed!) error term. <span class="math inline">\(\beta X\)</span> is referred to as the linear predictor.</p>
<p>When we want to predict species occurrence based on environment, then the conditional mean <span class="math inline">\(E(Y|X)\)</span> is binary and bounded between 0 (absence) and 1 (presence). Thus, the assumptions of OLS regression are not met. GLMs are more flexible regression models that allow the response variable to follow other distributions. Similar to OLS regression, we also fit a linear predictor <span class="math inline">\(\beta X\)</span> and then relate this linear predictor to the mean of the response variable using a link function. The link function is used to transform the response to normality. In case of a binary response, we typically use the logit link (or sometimes the probit link). The conditional mean is then given by:</p>
<p><span class="math display">\[E(Y|X) = \pi (X) = \frac{e^{\beta X+\epsilon}}{1+e^{\beta X+\epsilon}}\]</span></p>
<p>The logit transformation is defined as: <span class="math display">\[g(X)  = ln \left( \frac{\pi (X)}{1-\pi (X)} \right)   = \beta X+\epsilon\]</span></p>
<p>The trick is that the logit, g(X), is now linear in its parameters, is continuous and may range (<span class="math inline">\(-\infty,\infty\)</span>). GLMs with a logit link are also called logistic regression models.</p>
</div>
</div>
<div id="conceptualisation" class="section level1">
<h1><span class="header-section-number">2</span> Conceptualisation</h1>
<p>In the conceptualisation phase, we formulate our main research objectives and decide on the model and study setup based on any previous knowledge on the species and study system. An important point here is whether we can use available data or have to gather own biodiversity (and environmental) data, which would require deciding on an appropriate sampling design. Then, we carefully check the main underlying assumptions of SDMs, for example whether the species is in pseudo-equilibrium with environment and whether the data could be biased in any way <span class="citation">(cf. chapter 5 in Guisan, Thuiller, and Zimmermann 2017)</span>. The choice of adequate environmental predictors, of modelling algorithms and of desired model complexity should be guided by the research objective and by hypotheses regarding the species-environment relationship. We can divide environmental variables into three types of predictors: resource variables, direct variables and indirect variables <span class="citation">(Austin 1980; Guisan and Zimmermann 2000)</span>.</p>
<div id="example-ring-ouzel" class="section level2">
<h2><span class="header-section-number">2.1</span> Example: Ring Ouzel</h2>
<p>We aim at assessing potential climate change effects on the Ring Ouzel (<em>Turdus torquatus</em>) in Switzerland (Figure @ref(fig:birdfig)), a typical mountain bird in the Alps and Jura mountains. The <a href="https://www.vogelwarte.ch/en">Swiss Ornithological Institute</a> provides comprehensive information for all birds breeding in Switzerland. Thus, we first have a look at their website to find out more about <a href="https://www.vogelwarte.ch/en/birds/birds-of-switzerland/ring-ouzel">Ring Ouzel ecology</a>. Think about which factors could limit the distribution of Ring Ouzel in Switzerland.</p>
<div class="figure">
<img src="figures/ringouzel.png" alt="**Figure 3. A male ring ouzel. Copyright Ruedi Aeschlimann. Downloaded from www.vogelwarte.ch.**" width="40%" />
<p class="caption">
<strong>Figure 3. A male ring ouzel. Copyright Ruedi Aeschlimann. Downloaded from www.vogelwarte.ch.</strong>
</p>
</div>
<p>The Swiss Ornithological Institute has produced two distribution atlasses at 1 km resolution over the last two decades. These data, in particular the breeding bird atlas for 1993-1996 <span class="citation">(Schmid et al. 1998)</span> have been used previously. For example, <span class="citation">Zurell et al. (2019)</span> have made available the 1993-1996 distribution data of several breeding bird species along with environmental predictor variables, which we can use for our study. The study by <span class="citation">Zurell et al. (2019)</span> considered bioclimatic, topographic and remote-sensing based vegetation variables as relevant environmental predictors.</p>
<div class="alert alert-info">
<p><strong><strong>Questions:</strong></strong></p>
<ul>
<li>Do you think the Ring Ouzel is/was at equilibrium during the time period when the atlas data were gathered?</li>
<li>What relationship would you expect between Ring Ouzel occurrence and climate?</li>
<li>Which of the proposed environmental variables constitute resource, direct and indirect predictors?</li>
</ul>
</div>
</div>
</div>
<div id="data-preparation" class="section level1">
<h1><span class="header-section-number">3</span> Data preparation</h1>
<p>In this step, the actual biodiversity and environmental data are gathered and processed. This concerns all data that are required for model fitting but also data that are used for making transfers. In session 1, we have explored some ways to retrieve biodiversity data and environmental data, and how these can be joinded. Today, we can skip these steps as the biodiversity and environmental data are available for download from the supplementary material of <span class="citation">Zurell et al. (2019)</span>, or more specifically from a Dryad repository.</p>
<p><a href="https://doi.org/10.5061/dryad.k88v330">Download the data</a> and unzip it into your data folder. Then, read in the data:</p>
<pre class="r"><code>avi_dat &lt;- read.table(&#39;data/Data_SwissBreedingBirds.csv&#39;, header=T, sep=&#39;,&#39;)

summary(avi_dat)</code></pre>
<p>The data frame contains 2535 records with presence-absence information for 56 bird species, and 52 environmental predictor variables. The Ring Ouzel has a prevalence of ca. 0.25. Part of the data (70%) were used for single species distribution modelling <span class="citation">(Zurell et al. 2019)</span> and were already partitioned into spatial blocks in preparation for spatial block cross-validation <span class="citation">(Roberts et al. 2017)</span> - we will deal with this in session 4. The remaining 30% of the data were used for testing community level predictions, which is irrelevant for our purpose.</p>
<p>Let’s structure the data frame a little:</p>
<pre class="r"><code># Species names
avi_spp &lt;- names(avi_dat)[1:56]
sp &lt;- &quot;Turdus_torquatus&quot;

# Variable names
all_vars &lt;- names(avi_dat)[57:108]
clim_vars &lt;- names(avi_dat)[69:98]

avi_df &lt;- avi_dat[,c(sp,clim_vars)]

summary(avi_df)</code></pre>
<pre><code>##  Turdus_torquatus     bio_1             bio_10          bio_11        
##  Min.   :0.0000   Min.   :-0.5363   Min.   : 7.38   Min.   :-8.12753  
##  1st Qu.:0.0000   1st Qu.: 5.3261   1st Qu.:13.11   1st Qu.:-2.20872  
##  Median :0.0000   Median : 8.1541   Median :16.34   Median : 0.02445  
##  Mean   :0.2548   Mean   : 7.2725   Mean   :15.42   Mean   :-0.72079  
##  3rd Qu.:1.0000   3rd Qu.: 9.4525   3rd Qu.:17.92   3rd Qu.: 0.98350  
##  Max.   :1.0000   Max.   :12.8116   Max.   :21.62   Max.   : 3.98980  
##      bio_12         bio_13          bio_14           bio_15      
##  Min.   : 606   Min.   : 63.0   Min.   : 24.00   Min.   : 6.881  
##  1st Qu.:1112   1st Qu.:118.0   1st Qu.: 64.00   1st Qu.:14.306  
##  Median :1300   Median :144.0   Median : 75.00   Median :20.643  
##  Mean   :1381   Mean   :153.6   Mean   : 80.97   Mean   :21.497  
##  3rd Qu.:1608   3rd Qu.:182.0   3rd Qu.: 95.50   3rd Qu.:27.895  
##  Max.   :2890   Max.   :338.0   Max.   :177.00   Max.   :44.620  
##      bio_16          bio_17        bio_18          bio_19     
##  Min.   :169.0   Min.   : 88   Min.   :147.0   Min.   : 93.0  
##  1st Qu.:338.0   1st Qu.:211   1st Qu.:332.0   1st Qu.:220.0  
##  Median :413.0   Median :244   Median :405.0   Median :255.0  
##  Mean   :439.5   Mean   :265   Mean   :429.1   Mean   :278.7  
##  3rd Qu.:520.0   3rd Qu.:308   3rd Qu.:508.0   3rd Qu.:324.0  
##  Max.   :987.0   Max.   :564   Max.   :987.0   Max.   :613.0  
##      bio_2            bio_3           bio_4           bio_5      
##  Min.   : 5.592   Min.   :26.10   Min.   :563.1   Min.   :12.23  
##  1st Qu.: 7.789   1st Qu.:30.96   1st Qu.:631.8   1st Qu.:18.81  
##  Median : 8.293   Median :31.68   Median :664.7   Median :22.39  
##  Mean   : 8.243   Mean   :31.75   Mean   :658.0   Mean   :21.42  
##  3rd Qu.: 8.689   3rd Qu.:32.47   3rd Qu.:687.1   3rd Qu.:24.29  
##  Max.   :11.471   Max.   :36.40   Max.   :736.5   Max.   :28.27  
##      bio_6              bio_7           bio_8            bio_9        
##  Min.   :-12.7192   Min.   :21.31   Min.   :-4.635   Min.   :-7.5555  
##  1st Qu.: -6.0816   1st Qu.:24.84   1st Qu.:11.318   1st Qu.:-0.6454  
##  Median : -3.6965   Median :26.21   Median :14.862   Median : 1.6082  
##  Mean   : -4.5000   Mean   :25.92   Mean   :13.540   Mean   : 1.1906  
##  3rd Qu.: -2.6218   3rd Qu.:27.03   3rd Qu.:16.777   3rd Qu.: 2.6720  
##  Max.   : -0.5949   Max.   :31.51   Max.   :20.285   Max.   :18.1155  
##      ddeg0           ddeg5            mbal              mind       
##  Min.   : 5138   Min.   : 1825   Min.   :-967.00   Min.   :0.3544  
##  1st Qu.:17516   1st Qu.:11251   1st Qu.:-336.00   1st Qu.:0.8645  
##  Median :29522   Median :18452   Median :-156.00   Median :1.0778  
##  Mean   :27685   Mean   :17183   Mean   : -58.93   Mean   :1.0790  
##  3rd Qu.:39335   3rd Qu.:22144   3rd Qu.: 174.00   3rd Qu.:1.2589  
##  Max.   :54022   Max.   :37634   Max.   :1518.00   Max.   :2.4399  
##     pet_103           pet_49         pet_ave         pet_swrt    
##  Min.   :0.7112   Min.   :2.202   Min.   :1.456   Min.   :1.675  
##  1st Qu.:1.9632   1st Qu.:5.565   1st Qu.:3.771   1st Qu.:2.530  
##  Median :2.1279   Median :5.756   Median :3.941   Median :2.734  
##  Mean   :2.1825   Mean   :5.691   Mean   :3.937   Mean   :2.784  
##  3rd Qu.:2.4008   3rd Qu.:5.909   3rd Qu.:4.144   3rd Qu.:2.937  
##  Max.   :3.7854   Max.   :6.551   Max.   :5.060   Max.   :5.289  
##     prc_103           prc_49          prc_swrt     
##  Min.   : 264.8   Min.   : 298.1   Min.   :0.8483  
##  1st Qu.: 474.8   1st Qu.: 618.7   1st Qu.:1.1774  
##  Median : 548.4   Median : 743.8   Median :1.3490  
##  Mean   : 590.0   Mean   : 791.3   Mean   :1.3558  
##  3rd Qu.: 681.5   3rd Qu.: 930.3   3rd Qu.:1.5353  
##  Max.   :1197.5   Max.   :1719.4   Max.   :2.1811</code></pre>
<p>Last, for many model it is advisable to standardise the predictor variables as this will facilitate model convergence and interpretation.</p>
<pre class="r"><code># Standardise predictors
avi_dfst &lt;- avi_df
avi_dfst[,-1] &lt;- scale(avi_dfst[,-1], center=T, scale=T)</code></pre>
</div>
<div id="model-fitting" class="section level1">
<h1><span class="header-section-number">4</span> Model fitting</h1>
<p>Model fitting is at the heart of any SDM application. Important aspects to consider during the model fitting step are:</p>
<ul>
<li>How to deal with multicollinearity in the environmental data?</li>
<li>How many variables should be included in the model (without overfitting) and how should we select these?</li>
<li>Which model settings should be used?</li>
<li>When multiple model algorithms or candidate models are fitted, how to select the final model or average the models?</li>
<li>Do we need to test or correct for non-independence in the data (spatial or temporal autocorrelation, nested data)?</li>
<li>Do we want to threshold the predictions, and which threshold should be used?</li>
</ul>
<p>More detailed descriptions on these aspects can be found in <span class="citation">Franklin (2010)</span> and in <span class="citation">Guisan, Thuiller, and Zimmermann (2017)</span>.</p>
<div id="fitting-our-first-glm" class="section level2">
<h2><span class="header-section-number">4.1</span> Fitting our first GLM</h2>
<p>Before we start into the complexities of the different model fitting steps, let us look at a GLM in more detail. We fit our first GLM with only one predictor assuming a linear relationship between response and predictor. The <code>glm</code> function is contained in the R <em>stats</em> package. We need to specify a <em>formula</em> describing how the response should be related to the predictors, and the <em>data</em> specifying the data frame that contains the response and predictor variables, and a <em>family</em> argument specifying the type of response and the link function. In our case, we use the <em>logit</em> link in the <em>binomial</em> family.</p>
<pre class="r"><code># We first fit a GLM for the bio1 variable assuming a linear relationship:
m1 &lt;- glm(Turdus_torquatus ~ bio_1, family=&quot;binomial&quot;, data= avi_dfst)
    
# We can get a summary of the model:
summary(m1) </code></pre>
<pre><code>## 
## Call:
## glm(formula = Turdus_torquatus ~ bio_1, family = &quot;binomial&quot;, 
##     data = avi_dfst)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.8985  -0.3636  -0.2118   0.2204   2.3624  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.89945    0.08363  -22.71   &lt;2e-16 ***
## bio_1       -2.28932    0.08915  -25.68   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2877.6  on 2534  degrees of freedom
## Residual deviance: 1484.1  on 2533  degrees of freedom
## AIC: 1488.1
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>We can also fit quadratic or higher polynomial terms (check <code>?poly</code>) and interactions between predictors:<br />
- the term <code>I()</code>indicates that a variable should be transformed before being used as predictor in the formula<br />
- <code>poly(x,n)</code> creates a polynomial of degree <span class="math inline">\(n\)</span>: <span class="math inline">\(x + x^2 + ... + x^n\)</span><br />
- <code>x1:x2</code> creates a two-way interaction term between variables x1 and x2, the linear terms of x1 and x2 would have to be specified separately<br />
- <code>x1*x2</code> creates a two-way interaction term between variables x1 and x2 plus their linear terms<br />
- <code>x1*x2*x3</code> creates the linear terms of the three variables, all possible two-way interactions between these variables and the three-way interaction</p>
<pre class="r"><code># Fit a quadratic relationshop with bio1:
m1_q &lt;- glm(Turdus_torquatus ~ bio_1 + I(bio_1^2), family=&quot;binomial&quot;, data= avi_dfst)
summary(m1_q)
    
# Or use the poly() function:
summary( glm(Turdus_torquatus ~ poly(bio_1,2) , family=&quot;binomial&quot;, data= avi_dfst) )

# Fit two linear variables:
summary( glm(Turdus_torquatus ~ bio_1 + bio_3, family=&quot;binomial&quot;, data= avi_dfst) )

# Fit three linear variables:
summary( glm(Turdus_torquatus ~ bio_1 + bio_3 + bio_15, family=&quot;binomial&quot;, data= avi_dfst) )

# Fit three linear variables with up to three-way interactions
summary( glm(Turdus_torquatus ~ bio_1 * bio_3 * bio_15, family=&quot;binomial&quot;, data= avi_dfst) )

# Fit three linear variables with up to two-way interactions
summary( glm(Turdus_torquatus ~ bio_1 + bio_3 + bio_15 + bio_1:bio_3 + bio_1:bio_15 + bio_3:bio_15, family=&quot;binomial&quot;, data= avi_dfst) )</code></pre>
</div>
<div id="collinearity-and-variable-selection" class="section level2">
<h2><span class="header-section-number">4.2</span> Collinearity and variable selection</h2>
<p>GLMs (and many other statistical models) have problems to fit stable parameters if two or more predictor variables are highly correlated, resulting in so-called multicollinearity issues <span class="citation">(Dormann et al. 2013)</span>. To avoid these problems here, we start by checking for multi-collinearity and by selecting an initical set of predictor variables. Then, we can fit our GLM including multiple predictors and with differently complex response shapes. This model can then be further simplified by removing “unimportant” predictors.</p>
<div id="correlation-among-predictors" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Correlation among predictors</h3>
<p>We first check for pairwise correlations among predictors. Generally, correlations below |r|&lt;0.7 are considered unproblematic (or below |r|&lt;0.5 as more conservative threshold).</p>
<pre class="r"><code>library(corrplot)</code></pre>
<pre><code>## corrplot 0.84 loaded</code></pre>
<pre class="r"><code># We first estimate a correlation matrix from the predictors. We use Spearman rank correlation coefficient, as we do not know whether all variables are normally distributed.
cor_mat &lt;- cor(avi_df[,-1], method=&#39;spearman&#39;)

# We can visualise this correlation matrix. For better visibility, we plot the correlation coefficients as percentages.
corrplot.mixed(cor_mat, tl.pos=&#39;lt&#39;, tl.cex=0.6, number.cex=0.5, addCoefasPercent=T)</code></pre>
<p><img src="3_SDM_intro_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Several predictor variables are highly correlated. One way to deal with this issue is to remove the “less important” variable from the highly correlated pairs. For this, we need to assess variable importance.</p>
</div>
<div id="deviance-and-aic" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Deviance and AIC</h3>
<p>Before we can assess univariate variable importance, we need to know how!</p>
<p>Basically, we want to know whether a predictor is “important”. We thus need to evaluate whether a model including this variable tells us more about the response than a model without that variable <span class="citation">(Hosmer and Lemeshow 2013)</span>. Importantly, we do not look at the significance level of predictors. Such p-values merely tell us whether the slope coefficient is significantly different from zero. Rather, we assess whether the predicted values are closer to the observed values when the variable is included in the model versus when it is not included. In logistic regression, we compare the observed to predicted values using the log-likelihood function:</p>
<p><span class="math display">\[L( \beta ) = ln[l( \beta)] = \sum_{i=1}^{n} \left( y_i \times ln[\pi (x_i)] + (1-y_i) \times ln[1- \pi (x_i)] \right)\]</span></p>
<p><span class="math inline">\(L( \beta )\)</span> is the <em>Likelihood of the fitted model</em>. From this, we can calculate the deviance <span class="math inline">\(D\)</span> defined as:</p>
<p><span class="math display">\[D = -2 \times L\]</span></p>
<p>This deviance is an important measure used for comparing models. For example, it serves for the calculation of <em>Information criteria</em> that are used for comparing models containing different numbers of parameters. Here, we will use the <em>Akaike Information Criterion</em>, usually abbreviated as AIC. It is defined as: <span class="math display">\[AIC = -2 \times L + 2 \times (p+1) = D + 2 \times (p+1)\]</span></p>
<p>where <span class="math inline">\(p\)</span> is the number of regression coefficients in the model. AIC thus takes into account model complexity. In general, lower values of AIC are preferable.</p>
<p>We can also use the deviance to calculate the <em>Explained deviance</em> <span class="math inline">\(D^2\)</span>, which is the amount of variation explained by the model compared to the null expectation: <span class="math display">\[D^2 = 1 - \frac{D(model)}{D(Null.model)}\]</span></p>
<p>Strictly, <span class="math inline">\(D^2\)</span> should also be adjusted for the number of terms in the model: <span class="math display">\[D^2_{adj} = 1 - \left( \frac{(1-D^2)(n-1)}{n-p-1} \right)\]</span> where <span class="math inline">\(n\)</span> is the number of observations and <span class="math inline">\(p\)</span> is the number of regression coefficients (excluding the intercept).</p>
</div>
<div id="univariate-variable-importance" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Univariate variable importance</h3>
<p><span class="citation">Dormann et al. (2013)</span> suggest to assess univariate variable importance in terms of AIC (Akaike information criterion) or explained deviance (in GLMs, we speak of deviance instead of variance). In practice, this means that we fit a GLM separately for each predictor, assess the importance and then rank the variables according to their univariate importance.</p>
<p>Earlier, we already fitted GLMs with linear and quadratic terms. We can now easily extract the AIC from the fitted model objects. Which model is better in terms of AIC?</p>
<pre class="r"><code>AIC(m1) </code></pre>
<pre><code>## [1] 1488.077</code></pre>
<pre class="r"><code>AIC(m1_q)</code></pre>
<pre><code>## [1] 1253.51</code></pre>
<p>Including the possibility of a quadratic (unimodal) relationship seems sensible. We now want to estimate such a model for each potential predictor and rank the variables according to the AIC values obtained in the univariate models. For this, we write a little function:</p>
<pre class="r"><code>var.imp &lt;- function (predictor, response)
    {
      AIC(glm(response ~ predictor + I(predictor^2), binomial))
    }</code></pre>
<p>We can now apply this function to all predictor variables in our data. Check out the help page <code>?apply</code>:</p>
<pre class="r"><code>aic_imp &lt;- apply(avi_dfst[,-1], 2, var.imp, response= avi_dfst$Turdus_torquatus)</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre class="r"><code># Sort the predictors; the lower the AIC the better:
sort(aic_imp)</code></pre>
<pre><code>##    bio_5   bio_10    ddeg5    ddeg0    bio_1   bio_11    bio_6    bio_4 
## 1184.247 1202.443 1219.074 1238.800 1253.510 1382.574 1514.379 1593.033 
##    bio_7    bio_8    bio_9    bio_2   bio_17   bio_14   bio_19  prc_103 
## 1921.370 1993.861 2247.833 2295.649 2319.234 2332.297 2333.781 2335.924 
##   bio_12   bio_13   bio_16   bio_18   prc_49     mbal     mind  pet_103 
## 2422.766 2442.791 2478.398 2494.447 2529.855 2534.717 2565.443 2709.620 
##  pet_ave    bio_3 pet_swrt   pet_49 prc_swrt   bio_15 
## 2761.135 2784.603 2786.823 2852.323 2876.281 2879.398</code></pre>
</div>
<div id="variable-selection-removing-highly-correlated-variables" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Variable selection: removing highly correlated variables</h3>
<p>Now, it’s getting a bit more complicated. We need to identify all pairs of variables that have correlation |r|&gt;0.7 and remove the less important variable. <span class="citation">Dormann et al. (2013)</span> call this the <em>select07</em> method and also provide code.</p>
<p>Here is my adapted function:</p>
<pre class="r"><code>select07 &lt;- function(pred_names, response_name, data, cor_mat=NULL, threshold=0.7){

    # Function for calculating AIC - we use univariate GLMs with linear and quadratic terms
    var.imp &lt;- function (predictor, response)
    {
      AIC(glm(response ~ predictor + I(predictor^2), binomial))
    }
    
  # Calculate AIC for all predictor variables
  aic_imp &lt;- apply(data[pred_names], 2, var.imp, response= data[,response_name])
  
  # Names of sorted variables
    sort_imp &lt;- names(sort(aic_imp))
    
    # Calculate correlation matrix if not provided in function call
    if (is.null(cor_mat)) {
        cor_mat &lt;- cor(data[pred_names], method=&#39;spearman&#39;)
    }
    
    # Identifies correlated variable pairs:
    diag(cor_mat)=NA
    pairs &lt;- which(abs(cor_mat)&gt;= threshold, arr.ind=T) 
    
    # Identify which variables should be excluded
    exclude &lt;- NULL
    for (i in 1:length(sort_imp))
    {
        if ((sort_imp[i] %in% row.names(pairs))&amp;
            ((sort_imp[i] %in% exclude)==F)) {
                cv &lt;- cor_mat[setdiff(row.names(cor_mat),exclude),sort_imp[i]]
                cv &lt;- cv[setdiff(names(cv),sort_imp[1:i])]
                exclude &lt;- c(exclude,names(which((abs(cv)&gt;=threshold)))) 
            }
    }
    
    # Select set of weakly correlated predictors:
    pred_sel &lt;- sort_imp[!(sort_imp %in% exclude)]
    
    # Return list with AIC, correlation matrix, and final predictors:
    return(list(AIC=sort(aic_imp), cor_mat=cor_mat, pred_sel=pred_sel))
}</code></pre>
<p>Let’s try out the function:</p>
<pre class="r"><code>var_sel &lt;- select07(pred_names=clim_vars, response_name=sp, data=avi_dfst, cor_mat=cor_mat, threshold=0.7)</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre class="r"><code>pred_sel &lt;- var_sel$pred_sel</code></pre>
<p>So, we have now reduced our set of climatic variables from 30 to 6 predictors that are only weakly correlated. Now, we need to decide whether all of these should be included in the final model, or if we select only a few, for example the five most important variables in terms of univariate AIC. As a rule of thumb, we should have ten presence points per parameter fitted in the model <span class="citation">(Guisan, Thuiller, and Zimmermann 2017)</span>. We have 6 predictors and want to include quadratic terms as well, we would thus need at least 120 presences if we wanted to fit a model including all these 6 variables. Can we do this?</p>
<pre class="r"><code># How many presences and absences do we have in the data?
table(avi_dfst[,sp])</code></pre>
<pre><code>## 
##    0    1 
## 1889  646</code></pre>
<div class="alert alert-info">
<p><strong><strong>Tasks:</strong></strong></p>
<ul>
<li>Change the threshold in the <code>select07()</code> function to 0.5 and rerun the variable selection.</li>
<li>Do you find any difference in the selected variables?</li>
</ul>
</div>
</div>
</div>
<div id="model-selection" class="section level2">
<h2><span class="header-section-number">4.3</span> Model selection</h2>
<p>Now that we have selected a set of weakly correlated variables, we can fit the full model and then simplify it. The latter is typically called model selection.</p>
<pre class="r"><code># We first define our model formula:
our_model_formula &lt;- paste(sp, &#39;~&#39;,paste(pred_sel,paste0(&#39;+ I(&#39;,pred_sel,&#39;^2)&#39;),collapse=&#39; + &#39;))

# Then fit full model:
m_full &lt;- glm( as.formula(our_model_formula), family=&#39;binomial&#39;, data=avi_dfst)

# Inspect the model:
summary(m_full)</code></pre>
<pre><code>## 
## Call:
## glm(formula = as.formula(our_model_formula), family = &quot;binomial&quot;, 
##     data = avi_dfst)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6041  -0.0983  -0.0078   0.2978   3.4668  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -3.16417    0.23224 -13.625  &lt; 2e-16 ***
## bio_5         -6.31733    0.42679 -14.802  &lt; 2e-16 ***
## I(bio_5^2)    -1.84614    0.17849 -10.343  &lt; 2e-16 ***
## bio_2          0.68479    0.15757   4.346 1.39e-05 ***
## I(bio_2^2)    -0.04853    0.05982  -0.811  0.41721    
## bio_17         0.91937    0.30117   3.053  0.00227 ** 
## I(bio_17^2)   -0.02963    0.07500  -0.395  0.69282    
## bio_13         0.24284    0.32791   0.741  0.45895    
## I(bio_13^2)   -0.28237    0.08005  -3.527  0.00042 ***
## pet_103       -0.05101    0.06540  -0.780  0.43543    
## I(pet_103^2)   0.04635    0.04166   1.113  0.26589    
## prc_swrt      -0.03196    0.22122  -0.144  0.88513    
## I(prc_swrt^2)  0.07384    0.06603   1.118  0.26346    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2877.6  on 2534  degrees of freedom
## Residual deviance: 1078.5  on 2522  degrees of freedom
## AIC: 1104.5
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>How much deviance is explained by our model?</p>
<pre class="r"><code># Explained deviance:
library(ecospat)</code></pre>
<pre><code>## Loading required package: ade4</code></pre>
<pre><code>## Loading required package: ape</code></pre>
<pre><code>## Loading required package: gbm</code></pre>
<pre><code>## Loaded gbm 2.1.5</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;adehabitatMA&#39;:
##   method                       from
##   print.SpatialPixelsDataFrame sp  
##   print.SpatialPixels          sp</code></pre>
<pre class="r"><code>ecospat.adj.D2.glm(m_full)</code></pre>
<pre><code>## [1] 0.6234257</code></pre>
<p>We can simplify the model further by using stepwise variable selection. The function <code>step()</code> uses the AIC to compare different subsets of the model. Specifically, it will iteratively drop variables and add variables until the AIC cannot be improved further (meaning it will not decrease further).</p>
<pre class="r"><code>m_step &lt;- step(m_full) </code></pre>
<pre class="r"><code># Inspect the model:
summary(m_step)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Turdus_torquatus ~ bio_5 + I(bio_5^2) + bio_2 + 
##     bio_17 + bio_13 + I(bio_13^2), family = &quot;binomial&quot;, data = avi_dfst)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.5182  -0.1012  -0.0079   0.3142   3.5116  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -3.04176    0.20186 -15.068  &lt; 2e-16 ***
## bio_5       -6.30236    0.40918 -15.403  &lt; 2e-16 ***
## I(bio_5^2)  -1.89134    0.17254 -10.962  &lt; 2e-16 ***
## bio_2        0.59777    0.11504   5.196 2.03e-07 ***
## bio_17       0.82496    0.10540   7.827 4.98e-15 ***
## bio_13       0.27765    0.13905   1.997   0.0458 *  
## I(bio_13^2) -0.30964    0.05886  -5.260 1.44e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2877.6  on 2534  degrees of freedom
## Residual deviance: 1081.9  on 2528  degrees of freedom
## AIC: 1095.9
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<pre class="r"><code># Explained deviance:
ecospat.adj.D2.glm(m_step)</code></pre>
<pre><code>## [1] 0.623134</code></pre>
<p>Next week will be dedicated to the remaining modelling steps (iv) model assessment and (v) predictions. For this, we will continue to work with the ring ouzel models we fitted today. We should thus save these models for next week’s session:</p>
<pre class="r"><code>save(var_sel, m_full, m_step, file=&#39;GLMs_RingOuzel_session3.RData&#39;)</code></pre>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-Austin1980">
<p>Austin, M. P. 1980. “Searching for a Model for Use in Vegetation Analysis.” <em>Vegetatio</em> 42 (October). Springer Nature: 11–21.</p>
</div>
<div id="ref-Dormann2013">
<p>Dormann, C. F., J. Elith, S. Bacher, C. Buchmann, G. Carl, G. Carre, J. R. Garcia Marquez, et al. 2013. “Collinearity: A Review of Methods to Deal with It and a Simulation Study Evaluating Their Performance.” <em>Ecography</em> 36: 27–46.</p>
</div>
<div id="ref-Elith2009">
<p>Elith, J., and J. R. Leathwick. 2009. “Species Distribution Models: Ecological Explanation and Prediction Across Space and Time.” <em>Annual Review of Ecology, Evolution, and Systematics</em> 40: 677–97.</p>
</div>
<div id="ref-elith2008">
<p>Elith, J., J. R. Leathwick, and T. Hastie. 2008. “A Working Guide to Boosted Regression Trees.” <em>Journal of Animal Ecology</em> 77: 802–13.</p>
</div>
<div id="ref-Elith2011">
<p>Elith, J., S. J. Phillips, T. Hastie, M. Dudik, Y. E. Chee, and C. J. Yates. 2011. “A Statistical Explanation of Maxent for Ecologists.” <em>Diversity and Distributions</em> 17: 43–57.</p>
</div>
<div id="ref-Franklin2010">
<p>Franklin, J. 2010. <em>Mapping Species Distributions: Spatial Inference and Prediction</em>. Cambride University Press.</p>
</div>
<div id="ref-guisan2005">
<p>Guisan, A., and W. Thuiller. 2005. “Predicting Species Distribution: Offering More Than Simple Habitat Models.” <em>Ecology Letters</em> 8: 993–1009.</p>
</div>
<div id="ref-Guisan2017">
<p>Guisan, A., W. Thuiller, and N. E. Zimmermann. 2017. <em>Habitat Suitability and Distribution Models with Applications in R</em>. Cambride University Press.</p>
</div>
<div id="ref-Guisan2000">
<p>Guisan, A., and N. E. Zimmermann. 2000. “Predictive Habitat Distribution Models in Ecology.” <em>Ecological Modelling</em> 135: 147–86.</p>
</div>
<div id="ref-Hosmer2013">
<p>Hosmer, David W., and Stanley Lemeshow. 2013. <em>Applied Logistic Regression</em>. 3rd ed. John Wiley &amp; Sons, Inc.</p>
</div>
<div id="ref-IPBES2016">
<p>IPBES. 2016. <em>The Methodological Assessment Report on Scenarios and Models of Biodiversity and Ecosystem Services</em>. Edited by S. Ferrier, K. N. Ninan, P. Leadley, R. Alkemade, L. A. Acosta, H. R. Akcakaya, L. Brotons, et al. Secretariat of the Intergovernmental Science-Policy Platform on Biodiversity; Ecosystem Services, Bonn, Germany.</p>
</div>
<div id="ref-Merow2013">
<p>Merow, C., M. J. Smith, and J. A. Silander Jr. 2013. “A Practical Guide to Maxent for Modeling Species’ Distributions: What It Does, and Why Inputs and Settings Matter.” <em>Ecography</em> 36: 1058–69.</p>
</div>
<div id="ref-Peterson2011a">
<p>Peterson, A. T., J. Soberon, R.G. Pearson, R. P. Anderson, E. Martinez-Meyer, M. Nakamura, and M. B. Araujo. 2011. <em>Ecological Niches and Geographic Distributions</em>. Princeton University Press.</p>
</div>
<div id="ref-phillips2006">
<p>Phillips, S. J., R. P. Anderson, and R. E. Schapire. 2006. “Maximum Entropy Modeling of Species Geographic Distributions.” <em>Ecological Modelling</em> 190: 231–59.</p>
</div>
<div id="ref-Roberts2017">
<p>Roberts, D. R., V. Bahn, S. Ciuti, M. S. Boyce, J. Elith, G. Guillera-Arroita, S: Hauenstein, et al. 2017. “Cross-Validation Strategies for Data with Temporal, Spatial, Hierarchical, or Phylogenetic Structure.” <em>Ecography</em> 40: 913–29.</p>
</div>
<div id="ref-Schmid1998">
<p>Schmid, H., R. Luder, B. Naef-Daenzer, R. Graf, and N. Zbinden. 1998. <em>Schweizer Brutvogelatlas. Verbreitung Der Brutvoegel Inder Schweiz Und Im Fuerstentum Liechtenstein 1993-1996</em>. Swiss Ornithological Institute, Sempach, Switzerland.</p>
</div>
<div id="ref-Thuiller2009">
<p>Thuiller, W., B. Lafourcade, R. Engler, and M. B. Araujo. 2009. “BIOMOD - a Platform for Ensemble Forecasting of Species Distributions.” <em>Ecography</em> 32: 369–73.</p>
</div>
<div id="ref-Zurell2019">
<p>Zurell, D., N. E. Zimmermann, H. Gross, A. Baltensweiler, T. Sattler, and R. O. Wueest. 2019. “Testing Species Assemblage Predictions from Stacked and Joint Species Distribution Models.” <em>Journal of Biogeography</em>. <a href="https://doi.org/10.1111/jbi.13608">https://doi.org/10.1111/jbi.13608</a>.</p>
</div>
</div>
</div>

<!DOCTYPE html>
<html>

<br>
<hr />
<div id="footer">
<p>Damaris Zurell <a href="http://creativecommons.org/licenses/by/4.0/" >(CC BY 4.0)</a>.  </p>
</div>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
